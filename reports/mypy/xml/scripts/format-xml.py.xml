<?xml-stylesheet type="text/xsl" href="../../mypy-html.xslt"?><mypy-report-file name="scripts/format-xml.py" module="scripts.format-xml"><line any_info="No Anys on this line!" content="#!/usr/bin/env python3" number="1" precision="empty"/><line any_info="No Anys on this line!" content="&quot;&quot;&quot;" number="2" precision="empty"/><line any_info="No Anys on this line!" content="Format Odoo XML files for consistent style." number="3" precision="empty"/><line any_info="No Anys on this line!" content="&quot;&quot;&quot;" number="4" precision="empty"/><line any_info="No Anys on this line!" content="" number="5" precision="empty"/><line any_info="No Anys on this line!" content="import sys" number="6" precision="precise"/><line any_info="No Anys on this line!" content="import xml.etree.ElementTree as ET" number="7" precision="precise"/><line any_info="No Anys on this line!" content="from xml.dom import minidom" number="8" precision="precise"/><line any_info="No Anys on this line!" content="" number="9" precision="empty"/><line any_info="No Anys on this line!" content="" number="10" precision="empty"/><line any_info="No Anys on this line!" content="def format_xml_file(filepath):" number="11" precision="any"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Format an XML file with proper indentation.&quot;&quot;&quot;" number="12" precision="empty"/><line any_info="No Anys on this line!" content="    try:" number="13" precision="empty"/><line any_info="No Anys on this line!" content="        # Parse the XML file" number="14" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Explicit (x1)" content="        tree = ET.parse(filepath)" number="15" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        root = tree.getroot()" number="16" precision="any"/><line any_info="No Anys on this line!" content="" number="17" precision="empty"/><line any_info="No Anys on this line!" content="        # Convert to string and pretty print" number="18" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Explicit (x1)" content="        xml_str = ET.tostring(root, encoding='unicode')" number="19" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        dom = minidom.parseString(xml_str)" number="20" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        pretty_xml = dom.toprettyxml(indent=&quot;    &quot;)" number="21" precision="any"/><line any_info="No Anys on this line!" content="" number="22" precision="empty"/><line any_info="No Anys on this line!" content="        # Remove extra blank lines" number="23" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        lines = pretty_xml.split('\n')" number="24" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x7)" content="        lines = [line for line in lines if line.strip()]" number="25" precision="any"/><line any_info="No Anys on this line!" content="" number="26" precision="empty"/><line any_info="No Anys on this line!" content="        # Skip the XML declaration if it's already in the file" number="27" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        if lines[0].startswith('&lt;?xml'):" number="28" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            lines = lines[1:]" number="29" precision="any"/><line any_info="No Anys on this line!" content="" number="30" precision="empty"/><line any_info="No Anys on this line!" content="        # Write back to file" number="31" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x7)&#10;Explicit (x1)" content="        with open(filepath, 'w', encoding='utf-8') as f:" number="32" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            f.write('&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n')" number="33" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            f.write('\n'.join(lines))" number="34" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            f.write('\n')" number="35" precision="any"/><line any_info="No Anys on this line!" content="" number="36" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="        print(f&quot;✅ Formatted: {filepath}&quot;)" number="37" precision="any"/><line any_info="No Anys on this line!" content="        return True" number="38" precision="any"/><line any_info="No Anys on this line!" content="" number="39" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="    except ET.ParseError as e:" number="40" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="        print(f&quot;❌ XML Parse Error in {filepath}: {e}&quot;, file=sys.stderr)" number="41" precision="any"/><line any_info="No Anys on this line!" content="        return False" number="42" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="    except Exception as e:" number="43" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="        print(f&quot;❌ Error formatting {filepath}: {e}&quot;, file=sys.stderr)" number="44" precision="any"/><line any_info="No Anys on this line!" content="        return False" number="45" precision="any"/><line any_info="No Anys on this line!" content="" number="46" precision="empty"/><line any_info="No Anys on this line!" content="" number="47" precision="empty"/><line any_info="No Anys on this line!" content="def main():" number="48" precision="any"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Main function to process files passed as arguments.&quot;&quot;&quot;" number="49" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="    if len(sys.argv) &lt; 2:" number="50" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        print(&quot;Usage: format-xml.py &lt;xml_file&gt; [&lt;xml_file&gt; ...]&quot;)" number="51" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        sys.exit(1)" number="52" precision="any"/><line any_info="No Anys on this line!" content="" number="53" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="    success = True" number="54" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="    for filepath in sys.argv[1:]:" number="55" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        if filepath.endswith('.xml'):" number="56" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            if not format_xml_file(filepath):" number="57" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="                success = False" number="58" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        elif filepath.endswith('.csv'):" number="59" precision="any"/><line any_info="No Anys on this line!" content="            # CSV files don't need formatting, just skip" number="60" precision="empty"/><line any_info="No Anys on this line!" content="            continue" number="61" precision="any"/><line any_info="No Anys on this line!" content="" number="62" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="    sys.exit(0 if success else 1)" number="63" precision="any"/><line any_info="No Anys on this line!" content="" number="64" precision="empty"/><line any_info="No Anys on this line!" content="" number="65" precision="empty"/><line any_info="No Anys on this line!" content="if __name__ == &quot;__main__&quot;:" number="66" precision="precise"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="    main()" number="67" precision="any"/></mypy-report-file>
